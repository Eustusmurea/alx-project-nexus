apiVersion: 2019-12-01
location: eastus
name: projectnexus-group
properties:
  containers:
    - name: projectnexus-api
      properties:
        image: nexusregistryeustus.azurecr.io/projectnexus-api:v1
        resources:
          requests:
            cpu: 1
            memoryInGb: 1.5
        ports:
          - port: 8000
        environmentVariables:
          - name: SECRET_KEY
            value: "your-secret-key"
          - name: DEBUG
            value: "True"
          - name: POSTGRES_DB
            value: "movie_db"
          - name: POSTGRES_USER
            value: "eustus"
          - name: POSTGRES_PASSWORD
            value: "movies"
          - name: POSTGRES_HOST
            value: "postgres"
          - name: POSTGRES_PORT
            value: "5432"
          - name: REDIS_URL
            value: "redis://redis:6379/1"
    - name: postgres
      properties:
        image: postgres:15
        resources:
          requests:
            cpu: 1
            memoryInGb: 1
        ports:
          - port: 5432
        environmentVariables:
          - name: POSTGRES_DB
            value: "movie_db"
          - name: POSTGRES_USER
            value: "eustus"
          - name: POSTGRES_PASSWORD
            value: "movies"
    - name: redis
      properties:
        image: redis:7
        resources:
          requests:
            cpu: 0.5
            memoryInGb: 0.5
        ports:
          - port: 6379
  ipAddress:
    type: Public
    ports:
      - protocol: tcp
        port: 80
      - protocol: tcp
        port: 8000
  osType: Linux
  restartPolicy: Always
type: Microsoft.ContainerInstance/containerGroups
